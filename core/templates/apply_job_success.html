{% extends 'base.html' %}
{% block title %}Job Application Status • JobLink Kenya{% endblock %}

{% block content %}
<style>
  .status-wrap {
    min-height: 62vh;
    display: grid;
    place-items: center;
    padding: 2rem 1rem;
  }

  .status-card {
    width: min(680px, 100%);
    padding: clamp(1.25rem, 2.4vw, 2rem);
    border-radius: 1.2rem;
    background: linear-gradient(130deg, color-mix(in srgb, var(--card-bg), transparent 10%), color-mix(in srgb, var(--card-bg), #000 8%));
    border: 1px solid color-mix(in srgb, var(--text-accent), transparent 72%);
    box-shadow: 0 14px 40px color-mix(in srgb, #000, transparent 70%), 0 0 24px var(--glow-soft);
    text-align: center;
  }

  .status-title {
    margin: 0 0 .85rem;
    font-size: clamp(1.4rem, 3.2vw, 2rem);
    color: var(--text-accent);
  }

  .status-title.fail { color: var(--text-warning); }

  .status-sub {
    color: var(--text-main);
    margin-bottom: .45rem;
  }

  .status-meta {
    margin: .75rem auto 1rem;
    max-width: 520px;
    text-align: left;
    padding: .85rem .95rem;
    border-radius: .8rem;
    border: 1px solid color-mix(in srgb, var(--text-muted), transparent 58%);
    background: color-mix(in srgb, var(--bg-surface-soft), transparent 28%);
    color: var(--text-main);
  }

  .status-muted {
    color: var(--text-muted);
    margin: 1rem 0;
  }
</style>

<section class="status-wrap" data-aos="zoom-in-up">
  <div class="status-card">
    {% if success %}
      <h1 class="status-title">✅ Application Successful</h1>
      <p class="status-sub">Your application for <strong>{{ job.title }}</strong> has been submitted.</p>
    {% else %}
      <h1 class="status-title fail">⚠️ Already Applied</h1>
      <p class="status-sub">You've already applied for <strong>{{ job.title }}</strong>.</p>
    {% endif %}

    {% if job.company or job.location %}
      <div class="status-meta">
        {% if job.company %}<div><strong>Company:</strong> {{ job.company }}</div>{% endif %}
        {% if job.location %}<div><strong>Location:</strong> {{ job.location }}</div>{% endif %}
      </div>
    {% endif %}

    <p class="status-muted">Redirecting to job suggestions in <strong><span id="timer">5</span></strong> seconds.</p>
    <a href="{% url 'job_suggestions' %}" class="jl-theme-btn">Go to Job Suggestions</a>
  </div>
</section>

<script>
  let timeLeft = 5;
  const timer = document.getElementById('timer');

  const countdown = setInterval(() => {
    timeLeft -= 1;
    timer.textContent = timeLeft;
    if (timeLeft <= 0) {
      clearInterval(countdown);
      window.location.href = "{% url 'job_suggestions' %}";
    }
  }, 1000);
</script>
{% endblock %}
