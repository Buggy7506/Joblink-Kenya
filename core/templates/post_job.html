{% extends 'base.html' %}

{% block title %}Post Job{% endblock %}

{% block content %}
<div class="post-job-container">
  <h2 class="glow-heading">Post a Job</h2>

  <!-- Messages Popup -->
  {% if messages %}
    <div id="messages-popup">
      {% for message in messages %}
        <div class="message {{ message.tags }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}

  <form method="POST" class="job-form">
    {% csrf_token %}
    
    {% for field in form %}
      <div class="form-group">
        <label class="form-label">{{ field.label }}</label>
    
        {% if field.name == "location" %}
          {{ field|add_class:"form-input location-input" }}
          <input type="hidden" id="job-latitude" name="latitude" value="{{ form.instance.latitude|default:'' }}">
          <input type="hidden" id="job-longitude" name="longitude" value="{{ form.instance.longitude|default:'' }}">
    
        {% elif field.name == "salary" %}
          <strong>{{ field.value|floatformat:2|intcomma }}</strong>
          {{ field }}
    
        {% else %}
          {{ field }}
        {% endif %}
    
        {% for error in field.errors %}
          <div class="error">{{ error }}</div>
        {% endfor %}
      </div>
    {% endfor %}

    <button type="submit" class="submit-btn">Post</button>
  </form>
</div>

<style>
/* prevent inputs from overflowing */
* {
  box-sizing: border-box;
}

.post-job-container {
  max-width: 600px;
  margin: 60px auto;
  padding: 30px;
  background: var(--bg-card); /* theme-aware background */
  border-radius: 12px;
  box-shadow: 0 0 25px var(--glow-accent, rgba(128,0,255,0.4));
  color: var(--text-main); /* main text */
  overflow: hidden;
  transition: background 0.4s, color 0.4s, box-shadow 0.4s;
}

.glow-heading {
  text-align: center;
  font-size: 2.5rem;
  margin-bottom: 30px;
  color: var(--text-accent); /* accent color */
  text-shadow: 0 0 5px var(--glow-accent), 0 0 10px var(--glow-accent);
  transition: color 0.4s, text-shadow 0.4s;
}

.job-form .form-group {
  margin-bottom: 20px;
}

.form-label {
  display: block;
  margin-bottom: 8px;
  font-weight: bold;
  color: var(--text-accent);
  transition: color 0.4s;
}

input, select, textarea {
  width: 100%;
  padding: 10px 14px;
  border: none;
  border-radius: 8px;
  background-color: rgba(46,46,62,0.9); /* subtle theme-aware input background */
  color: var(--text-main);
  font-size: 1rem;
  box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
  transition: box-shadow 0.2s ease, background 0.4s, color 0.4s;
}

input:focus, select:focus, textarea:focus {
  outline: none;
  box-shadow: 0 0 10px var(--glow-accent);
}

.submit-btn {
  background: linear-gradient(45deg, var(--glow-accent), var(--text-accent));
  border: none;
  padding: 12px 20px;
  border-radius: 10px;
  width: 100%;
  color: var(--text-main);
  font-weight: bold;
  font-size: 1rem;
  cursor: pointer;
  box-shadow: 0 0 10px var(--glow-accent);
  transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.3s;
}

.submit-btn:hover {
  background: linear-gradient(45deg, var(--text-accent), var(--glow-accent));
  transform: scale(1.02);
}

.error {
  color: var(--text-danger);
  font-size: 0.875rem;
  margin-top: 4px;
}

/* Messages Popup */
#messages-popup {
  position: fixed;
  top: 0;
  left: 50%;
  transform: translateX(-50%) translateY(-100%);
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 10px;
  animation: slideDown 0.5s forwards;
}

.message {
  background-color: var(--glow-accent, #ffb347);
  color: var(--text-main);
  padding: 12px 20px;
  border-radius: 25px;
  font-weight: bold;
  box-shadow: 0 0 10px var(--glow-accent), 0 0 20px var(--glow-accent);
  opacity: 0.95;
  transition: background 0.4s, color 0.4s, box-shadow 0.4s;
}

.message.error {
  background-color: var(--text-danger);
  color: var(--text-main);
  box-shadow: 0 0 10px var(--text-danger), 0 0 20px var(--text-danger);
}

@keyframes slideDown {
  to { transform: translateX(-50%) translateY(20px); }
}

@keyframes fadeOut {
  to { opacity: 0; transform: translateX(-50%) translateY(-50px); }
}
</style>

<script>
  // Automatically fade and remove messages
  setTimeout(() => {
    const popup = document.getElementById('messages-popup');
    if (popup) {
      popup.style.animation = 'fadeOut 0.5s forwards';
    }
  }, 3000);

  setTimeout(() => {
    const popup = document.getElementById('messages-popup');
    if (popup) popup.remove();
  }, 3500);
</script>
{% endblock %}
